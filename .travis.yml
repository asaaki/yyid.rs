sudo: false
language: rust
rust:
  - stable
  - beta
  - nightly
cache: cargo
matrix:
  allow_failures:
    - rust: nightly
before_script: |
  cargo install rustfmt || true
script: |
  export PATH=$PATH:~/.cargo/bin &&
  cargo fmt -- **/*.rs --write-mode=diff &&
  cargo build &&
  cargo test
after_success: |
  [ $TRAVIS_BRANCH = master ] &&
  [ $TRAVIS_PULL_REQUEST = false ] &&
  cargo doc &&
  echo "<meta http-equiv=refresh content=0;url=yyid/index.html>" > target/doc/index.html &&
  pip install --user ghp-import &&
  export PATH=$PATH:$HOME/.local/bin &&
  ghp-import -n target/doc &&
  git push -fq https://${GH_TOKEN}@github.com/${TRAVIS_REPO_SLUG}.git gh-pages
env:
  global:
    secure: gyA8zom7bXPQ1owUZPNHjBHN2rvMANshvBQCh3WKQY9h1kPpf4DEglN+nahJRPFmtTVlZFztuOBV6RI6RFa7PvD5EWqXE3S/6EWb8FgkFk5ER01hj9/lR9TjWB942WtyNmdrnCUNRG9JSfjaciPt+4aVHcVPrWx4JIV7flp9LDUSy02JFylZv+zHv5zgyuqjW4Zsp2BoByIlTYgwlgL7CXDwxOFUq68BMifnN1Ecf1UgxPBYVn8ukqDkfoznw1QtFsj9zoyb3o19XtVZgTmgjFZrE0U17xA3lSIdK8FlVg5NLkdKjgizWuN34II9S8q8KGVDu+koZXy5EhKWAzyNFPhTVWeZunQQPrB4ABZaPllW5YxCveDFAcP/CG+v0+Ai/VgqUmhlrM0uIpNEIPGaQ4KFJsyLMsiF+UT8JprIbjR3bvyj9w9VLUhTpbo/+9kPjRTB7NRA7ZvkZPDWFtMto305L9wwUAGX+qynSiVC1OZc9o5jBgQOWsJZ6uO0U86O5doQNbK6FtOjnQcGFAVFgqjiVCiqYO0ioI6hPUwXR9RAm1kR4+9nIvdwhZ6yGuSQQH+bcOG2fgj7G5yaLWpBvMcipiSQm3U8elQJ3vKrYd31Q410KiTFedD+M56320oGW8POd8IAxjkWRccdHf0z5U6fTQeLC8RCCd+L2PgsEL4=
